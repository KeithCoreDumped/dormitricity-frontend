# プロジェクトのアーキテクチャについて

Dormitricityは、信頼性の高いリアルタイムの電力監視サービスを提供するために、モダンな分散システムとして設計されています。このプロジェクトは、互いに連携して動作する3つの独立した疎結合コンポーネントで構成されています。

{/* ```mermaid
graph TD
    A[ユーザー] <--> B(フロントエンド);
    B <--> C{ワーカー};
    C --> D[クローラー];
``` */}

### 1. フロントエンド (Frontend)

フロントエンドは、すべてのユーザーインタラクションに対してレスポンシブで直感的なインターフェースを提供する、主要なユーザー向けコンポーネントです。

-   **技術**: **Next.js**、**React**、**TypeScript**で構築されています。スタイリングには**Tailwind CSS**と**shadcn/ui**を使用しています。
-   **役割**: ユーザー登録、ログイン、ダッシュボードの視覚化、通知設定の構成を担当します。データとビジネスロジックをワーカーに完全に依存する純粋なクライアントアプリケーションです。
-   **インタラクション**: 安全なREST APIを介してワーカーとのみ通信します。

### 2. ワーカー (Worker)

ワーカーはプロジェクトの中枢神経系です。Cloudflareネットワーク上で実行されるサーバーレスバックエンドであり、高速でスケーラブルです。

-   **技術**: **TypeScript**で書かれた**Cloudflare Worker**で、ストレージには**Cloudflare D1** SQLiteデータベースを使用しています。
-   **役割**: 唯一の信頼できる情報源（source of truth）として機能します。データベースの管理、すべてのビジネスロジック（ユーザー認証、サブスクリプション、通知ルール）の処理、フロントエンドへのAPI提供を行います。重要なことに、クローラーの**オーケストレーター**としても機能します。
-   **インタラクション**: フロントエンドからのAPI呼び出しに応答し、新しいデータを取得する必要がある場合にGitHub Actionsワークフローをディスパッチしてクローラーをトリガーします。

### 3. クローラー (Crawler)

クローラーは、ウェブサイトから電力データをスクレイピングする役割を担う、専門的でステートレスなデータ取得エージェントです。

-   **技術**: **Python**スクリプトで、**Selenium**および**Requests**ライブラリを使用しています。
-   **役割**: その唯一の目的は、生の電力データを取得することです。ワーカーからチェックする寮の「スライス」を要求するジョブベースで動作します。
-   **インタラクション**: ワーカーによってオンデマンドでトリガーされます。アクティブになると、ジョブを要求し、必要なデータをスクレイピングし、結果を処理と保存のためにワーカーのインジェストエンドポイントに送り返します。

この疎結合アーキテクチャにより、システムの各部分が専門化され、スケーラブルであり、独立して開発および保守できることが保証されます。

## ソースコードと貢献

プロジェクト全体がオープンソースです。各コンポーネントのソースコードはGitHubで確認できます：

-   [**フロントエンドリポジトリ**](https://github.com/KeithCoreDumped/dormitricity-frontend)
-   [**ワーカーリポジトリ**](https://github.com/KeithCoreDumped/dormitricity-worker)
-   [**クローラーリポジトリ**](https://github.com/KeithCoreDumped/dormitricity-crawler)

データ収集ジョブのステータスは、[クローラーのGitHub Actionsページ](https://github.com/KeithCoreDumped/dormitricity-crawler/actions)で監視できます。

フィードバックやバグ報告を歓迎します。問題が発生した場合は、お気軽に[Issueをオープン](https://github.com/KeithCoreDumped/dormitricity-frontend/issues)してください。
